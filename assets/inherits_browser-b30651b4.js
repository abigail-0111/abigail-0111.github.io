import{b_ as U,b$ as F,c0 as X,c1 as l,c2 as j,c3 as v,aU as E}from"./provider-browser-5807d46b.js";const _=BigInt(2**32-1),b=BigInt(32);function O(n,t=!1){return t?{h:Number(n&_),l:Number(n>>b&_)}:{h:Number(n>>b&_)|0,l:Number(n&_)|0}}function M(n,t=!1){let s=new Uint32Array(n.length),e=new Uint32Array(n.length);for(let o=0;o<n.length;o++){const{h:i,l:r}=O(n[o],t);[s[o],e[o]]=[i,r]}return[s,e]}const N=(n,t)=>BigInt(n>>>0)<<b|BigInt(t>>>0),P=(n,t,s)=>n>>>s,R=(n,t,s)=>n<<32-s|t>>>s,z=(n,t,s)=>n>>>s|t<<32-s,K=(n,t,s)=>n<<32-s|t>>>s,W=(n,t,s)=>n<<64-s|t>>>s-32,$=(n,t,s)=>n>>>s-32|t<<64-s,q=(n,t)=>t,D=(n,t)=>n,G=(n,t,s)=>n<<s|t>>>32-s,J=(n,t,s)=>t<<s|n>>>32-s,Q=(n,t,s)=>t<<s-32|n>>>64-s,V=(n,t,s)=>n<<s-32|t>>>64-s;function Y(n,t,s,e){const o=(t>>>0)+(e>>>0);return{h:n+s+(o/2**32|0)|0,l:o|0}}const Z=(n,t,s)=>(n>>>0)+(t>>>0)+(s>>>0),C=(n,t,s,e)=>t+s+e+(n/2**32|0)|0,tt=(n,t,s,e)=>(n>>>0)+(t>>>0)+(s>>>0)+(e>>>0),st=(n,t,s,e,o)=>t+s+e+o+(n/2**32|0)|0,nt=(n,t,s,e,o)=>(n>>>0)+(t>>>0)+(s>>>0)+(e>>>0)+(o>>>0),et=(n,t,s,e,o,i)=>t+s+e+o+i+(n/2**32|0)|0,f={fromBig:O,split:M,toBig:N,shrSH:P,shrSL:R,rotrSH:z,rotrSL:K,rotrBH:W,rotrBL:$,rotr32H:q,rotr32L:D,rotlSH:G,rotlSL:J,rotlBH:Q,rotlBL:V,add:Y,add3L:Z,add3H:C,add4L:tt,add4H:st,add5H:et,add5L:nt},[I,B,H]=[[],[],[]],ot=BigInt(0),u=BigInt(1),rt=BigInt(2),it=BigInt(7),ct=BigInt(256),ht=BigInt(113);for(let n=0,t=u,s=1,e=0;n<24;n++){[s,e]=[e,(2*s+3*e)%5],I.push(2*(5*e+s)),B.push((n+1)*(n+2)/2%64);let o=ot;for(let i=0;i<7;i++)t=(t<<u^(t>>it)*ht)%ct,t&rt&&(o^=u<<(u<<BigInt(i))-u);H.push(o)}const[at,lt]=f.split(H,!0),L=(n,t,s)=>s>32?f.rotlBH(n,t,s):f.rotlSH(n,t,s),w=(n,t,s)=>s>32?f.rotlBL(n,t,s):f.rotlSL(n,t,s);function S(n,t=24){const s=new Uint32Array(10);for(let e=24-t;e<24;e++){for(let r=0;r<10;r++)s[r]=n[r]^n[r+10]^n[r+20]^n[r+30]^n[r+40];for(let r=0;r<10;r+=2){const c=(r+8)%10,d=(r+2)%10,k=s[d],a=s[d+1],m=L(k,a,1)^s[c],T=w(k,a,1)^s[c+1];for(let x=0;x<50;x+=10)n[r+x]^=m,n[r+x+1]^=T}let o=n[2],i=n[3];for(let r=0;r<24;r++){const c=B[r],d=L(o,i,c),k=w(o,i,c),a=I[r];o=n[a],i=n[a+1],n[a]=d,n[a+1]=k}for(let r=0;r<50;r+=10){for(let c=0;c<10;c++)s[c]=n[r+c];for(let c=0;c<10;c++)n[r+c]^=~s[(c+2)%10]&s[(c+4)%10]}n[0]^=at[e],n[1]^=lt[e]}s.fill(0)}class p extends X{constructor(t,s,e,o=!1,i=24){if(super(),this.blockLen=t,this.suffix=s,this.outputLen=e,this.enableXOF=o,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,l.number(e),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=j(this.state)}keccak(){S(this.state32,this.rounds),this.posOut=0,this.pos=0}update(t){l.exists(this);const{blockLen:s,state:e}=this;t=v(t);const o=t.length;for(let i=0;i<o;){const r=Math.min(s-this.pos,o-i);for(let c=0;c<r;c++)e[this.pos++]^=t[i++];this.pos===s&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:s,pos:e,blockLen:o}=this;t[e]^=s,s&128&&e===o-1&&this.keccak(),t[o-1]^=128,this.keccak()}writeInto(t){l.exists(this,!1),l.bytes(t),this.finish();const s=this.state,{blockLen:e}=this;for(let o=0,i=t.length;o<i;){this.posOut>=e&&this.keccak();const r=Math.min(e-this.posOut,i-o);t.set(s.subarray(this.posOut,this.posOut+r),o),this.posOut+=r,o+=r}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return l.number(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(l.output(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:s,suffix:e,outputLen:o,rounds:i,enableXOF:r}=this;return t||(t=new p(s,e,o,r,i)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=i,t.suffix=e,t.outputLen=o,t.enableXOF=r,t.destroyed=this.destroyed,t}}const h=(n,t,s)=>U(()=>new p(t,n,s)),ut=h(6,144,224/8),ft=h(6,136,256/8),pt=h(6,104,384/8),dt=h(6,72,512/8),kt=h(1,144,224/8),y=h(1,136,256/8),xt=h(1,104,384/8),_t=h(1,72,512/8),A=(n,t,s)=>F((e={})=>new p(t,n,e.dkLen===void 0?s:e.dkLen,!0)),bt=A(31,168,128/8),yt=A(31,136,256/8),Lt=Object.freeze(Object.defineProperty({__proto__:null,Keccak:p,keccakP:S,keccak_224:kt,keccak_256:y,keccak_384:xt,keccak_512:_t,sha3_224:ut,sha3_256:ft,sha3_384:pt,sha3_512:dt,shake128:bt,shake256:yt},Symbol.toStringTag,{value:"Module"})),wt=(()=>{const n=E(y);return n.create=y.create,n})();var g={exports:{}};typeof Object.create=="function"?g.exports=function(t,s){s&&(t.super_=s,t.prototype=Object.create(s.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:g.exports=function(t,s){if(s){t.super_=s;var e=function(){};e.prototype=s.prototype,t.prototype=new e,t.prototype.constructor=t}};var Ot=g.exports;export{Ot as i,wt as k,Lt as s};
